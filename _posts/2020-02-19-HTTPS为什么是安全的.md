---
layout: post
title:  "Https为什么是安全的"
date:   2020-02-19 11:00:54 -0000
categories: 网络
---

如果不了解[Https](https://en.wikipedia.org/wiki/HTTPS)是什么, 可以先点击去wiki了解一下，这里不在赘述。

首先我们定义一下什么是安全，通俗的说就是真实的request 和 response 内容（有业务意义的），即使被黑客截取，也是无法读取的。你的消息可能会丢失，但是除了和你通信的人，不会被其他人读到。

下面我们通过流程来看一下为什么https是安全的。  

！[流程图](img/https.jpg)

---

##### 1. client端发送https建立连接的请求。

##### 2. server端收到请求，返回包含公匙的证书，通过此公匙加密之后的内容，只能通过私匙解密，server端拥有唯一私匙。

    证书：证书本质上是借用第三方来确定身份的可靠性。机构发布证书，浏览器信任证书。或者个人发布证书，个人添加信任，这样的话个人既能控制client，又能控制server， 那就没有黑请求的必要了。

    公匙私匙：非对称加密的概念，即加密和解密不是用同一个密匙，公钥负责加密，私钥负责解密，即使加密内容被截获，没有私钥也不能破解，算法速度较慢。可以理解为寄了一个打开的保险箱到client，把东西（对称加密的密匙）放进去，合上保险箱寄回server，只有server有钥匙才能打开。

##### 3. client端收到证书，TLS验证证书的合法性。 

    这里的关键是保证黑客的证书不能取得client的信任。

##### 4. 产生一个随机数作为对称加密的random-key， 用收到的公匙将random-key加密，发送给server。 

    随机数可以保证一次连接一个对称密匙，截取本地保存的密匙，下次请求时也是没用的。

##### 5. server 用私匙解密random-key, 获得了用于解密request内容，和加密response内容的对称密匙。  

    此密匙因为前面的步骤，保证了只有此次连接的server和client端持有。对称加密算法更快。

##### 6 传输和解码 加密的内容





